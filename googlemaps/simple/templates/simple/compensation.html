<head>
    <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>
<form id="compensation_form" method="post">
    {% csrf_token %}
    Choose the competency level:
    <select name="level">
        <option value="ceo">CEO/President</option>
        <option value="vp">VP</option>
        <option value="lead">Team Leader</option>
        <option value="professional">Professional</option>
    </select>
    <br/>
    Salary per year:
    <input type="number" name="salary" value="70000"/>
    <br/>
    Years of service:
    <input type="number" name="years" value="10"/>
    <br/>
    <input type="submit" value="Predict Compensation in Months">
</form>

Compensation is : 
<div id="compensation_value"></div>

<div id="plotly_json"></div>
<script>
    $("#compensation_form").submit(function (event) {
      console.log($('[name="level"]').val());
      process_compensation();
      event.preventDefault();
    });

    function process_compensation()
    {
        console.log("Level=", $('[name="level"]').val());
        console.log("Salary=", $('[name="salary"]').val());
        console.log("Salary=", $('[name="years"]').val());
        $.ajax(
        {
            url : "{% url 'process-compensation' %}", 
            type : "POST",
            data : {    
                        level : $('[name="level"]').val(),  
                        salary : $('[name="salary"]').val(),
                        years : $('[name="years"]').val(),
                        csrfmiddlewaretoken: '{{csrf_token}}',
                    }, 

            // handle a successful response
            success : function(raw) {
                console.log("X=", raw.x);
                console.log("Y=", raw.y);
                var traceCEO = {
                                    name: "CEO",
                                    x: raw.years, 
                                    y: raw.predceo,
                                    mode: "lines+markers" 
                                };

                var traceVP = {
                                  name: "VP",
                                  x: raw.years,
                                  y: raw.predvp,
                                  mode: "lines+markers"          
                              };

                var traceLead = {
                                    name: "Lead",
                                    x: raw.years,
                                    y: raw.predlead,
                                    mode: "lines+markers"          
                                };

                var traceProf = {
                                    name: "Prof",
                                    x: raw.years,
                                    y: raw.predprof,
                                    mode: "lines+markers"          
                                };


                var data = [traceCEO, traceVP, traceLead, traceProf];
                var layout = 
                {
                    title: "Delay for different levels for salary " + raw.salary,
                };
                Plotly.newPlot('plotly_json', data, layout);
                $("#compensation_value").html(raw.delay);
            },
        });
    };
</script>
